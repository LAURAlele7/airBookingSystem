{% extends "base.html" %}
{% block title %}Register{% endblock %}

{% block head_extra %}
<style>
    .auth-card {
        max-width: 500px;
        margin: 40px auto;
        padding: 30px;
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        border: 1px solid #eee;
    }
    .auth-card h2 { text-align: center; margin-bottom: 20px; color: #333; }
    
    .role-group { display: flex; gap: 15px; justify-content: center; margin-bottom: 20px; }
    .role-option { cursor: pointer; }
    .role-option input { margin-right: 5px; }
    
    .form-group { margin-bottom: 15px; }
    .form-group label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 0.9em; }
    .form-control { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
    
    .btn-submit { width: 100%; padding: 12px; background: #28a745; color: white; border: none; border-radius: 4px; font-size: 1em; cursor: pointer; }
    .btn-submit:hover { background: #218838; }

    .perm-group { display: flex; gap: 20px; margin-top: 5px; }
</style>
{% endblock %}

{% block content %}
<div class="auth-card">
    <h2>Create Account</h2>
    <form method="post">
        <!-- Role Selection (Radio Buttons) -->
        <div class="role-group">
            <label class="role-option">
                <input type="radio" name="role" value="customer" checked onchange="onRoleChange()"> Customer
            </label>
            <label class="role-option">
                <input type="radio" name="role" value="agent" onchange="onRoleChange()"> Booking Agent
            </label>
            <label class="role-option">
                <input type="radio" name="role" value="staff" onchange="onRoleChange()"> Airline Staff
            </label>
        </div>

        <div class="form-group">
            <label>Email / Username:</label>
            <input type="text" name="email_or_username" class="form-control" required>
        </div>

        <!-- Customer Fields -->
        <div id="customer-extra">
            <div class="form-group">
                <label>Full Name:</label>
                <input type="text" name="name" class="form-control">
            </div>
            <div class="form-group">
                <label>Building Number:</label>
                <input type="number" name="building_number" class="form-control" min="0">
            </div>
            <div class="form-group">
                <label>Street:</label>
                <input type="text" name="street" class="form-control">
            </div>
            <div class="form-group">
                <label>City:</label>
                <input type="text" name="city" class="form-control">
            </div>
            <div class="form-group">
                <label>State:</label>
                <input type="text" name="state" class="form-control">
            </div>
            <div class="form-group">
                <label>Phone Number:</label>
                <input type="tel" name="phone_number" class="form-control">
            </div>
            <div class="form-group">
                <label>Passport Expiration Date:</label>
                <input type="date" name="passport_expiration_date" class="form-control">
            </div>
            <div class="form-group">
                <label>Passport Country:</label>
                <input type="text" name="passport_country" class="form-control">
            </div>
            <div class="form-group">
                <label>Date of Birth:</label>
                <input type="date" name="date_of_birth" class="form-control">
            </div>
        </div>

        <!-- Staff Fields -->
        <div id="staff-extra" style="display:none;">
            <div class="form-group">
                <label>First Name:</label>
                <input type="text" name="first_name" class="form-control">
            </div>
            <div class="form-group">
                <label>Last Name:</label>
                <input type="text" name="last_name" class="form-control">
            </div>
            <div class="form-group">
                <label>Airline:</label>
                <select name="airline_name" class="form-control">
                    <option value="">-- Select Airline --</option>
                    {% for a in airlines %}
                    <option value="{{ a.name }}">{{ a.name }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="form-group" style="background: #f8f9fa; padding: 10px; border-radius: 4px;">
                <label>Permission Role (Choose One):</label>
                <div class="perm-group">
                    <label><input type="radio" name="permission_type" value="Admin"> Admin</label>
                    <label><input type="radio" name="permission_type" value="Operator"> Operator</label>
                </div>
            </div>
        </div>

        <div class="form-group">
            <label>Password:</label>
            <input type="password" name="password" class="form-control" required>
        </div>
        <div class="form-group">
            <label>Confirm Password:</label>
            <input type="password" name="confirm_password" class="form-control" required>
        </div>

        <button type="submit" class="btn-submit">Register</button>
        <p style="text-align: center; margin-top: 15px; font-size: 0.9em;">
            Already have an account? <a href="{{ url_for('auth.login') }}">Login here</a>
        </p>
    </form>
</div>

<script>
function onRoleChange() {
    var role = document.querySelector('input[name="role"]:checked').value;
    
    document.getElementById("customer-extra").style.display = (role === "customer") ? "block" : "none";
    document.getElementById("staff-extra").style.display = (role === "staff") ? "block" : "none";
}
document.addEventListener('DOMContentLoaded', onRoleChange);
</script>
{% endblock %}